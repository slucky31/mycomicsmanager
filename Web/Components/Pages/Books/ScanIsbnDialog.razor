@using Microsoft.JSInterop

<MudDialog>
    <DialogContent>
        <MudContainer Style="text-align: center; padding: 0;">            
            <MudText Typo="Typo.body1" Class="mb-4">
                Point your camera at the ISBN barcode
            </MudText>
            <div style="position: relative; width: 100%; max-width: 400px; margin: 0 auto;">
                <video id="@_videoElementId"
                        style="width: 100%; height: auto; border: 2px solid #ddd; border-radius: 8px; display: block;"
                        autoplay
                        playsinline>
                </video>
                
                <!-- Visual guide to center the barcode -->
                <div style="position: absolute; 
                            top: 50%; 
                            left: 50%; 
                            transform: translate(-50%, -50%);
                            width: 80%;
                            height: 30%;
                            border: 3px solid @(_isbnDetected ? "#4caf50" : "#ff6b6b");
                            border-radius: 8px;
                            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
                            pointer-events: none;
                            transition: border-color 0.3s ease;">
                    <div style="position: absolute;
                                top: -30px;
                                left: 50%;
                                transform: translateX(-50%);
                                background: @(_isbnDetected ? "rgba(76, 175, 80, 0.9)" : "rgba(255, 107, 107, 0.9)");
                                color: white;
                                padding: 4px 12px;
                                border-radius: 4px;
                                font-size: 0.875rem;
                                white-space: nowrap;
                                transition: background-color 0.3s ease;">
                        @(_isbnDetected ? "? ISBN detected!" : "Align barcode here")
                    </div>
                </div>
            </div>                                  

            @if (!string.IsNullOrEmpty(_errorMessage))
            {
                <MudAlert Severity="Severity.Error" Class="mt-4">
                    @_errorMessage
                </MudAlert>
            }
        </MudContainer>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
    </DialogActions>
</MudDialog>

<style>
    /* Ensure the dialog is responsive on mobile */
    .mud-dialog-content {
        overflow-x: hidden !important;
    }
    
    @@media (max-width: 600px) {
        .mud-dialog {
            margin: 8px !important;
            max-height: calc(100vh - 16px) !important;
        }
        
        .mud-dialog-content {
            padding: 8px !important;
        }
    }
</style>
